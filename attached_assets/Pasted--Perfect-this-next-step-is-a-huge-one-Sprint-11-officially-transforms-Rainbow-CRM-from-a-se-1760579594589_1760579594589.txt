ğŸ”¥ Perfect â€” this next step is a huge one. Sprint 11 officially transforms **Rainbow CRM** from a service app into a *creative ecosystem*.

Below is your **ready-to-paste Replit Architect Payload** for **Sprint 11 â€” Mirror Marketplace & Asset Library**.
It connects everything youâ€™ve built (branding, automations, calendar, analytics) to a real-time asset marketplace â€” for backdrops, photo-booth templates, prompt packs, or any digital deliverable your users want to trade or sell.

---

## ğŸ§© **Payload â€” Rainbow CRM: Mirror Marketplace & Asset Library (Sprint 11)**

````
Create a new Sprint called "Mirror Marketplace & Asset Library (Sprint 11)" for Project Rainbow CRM.

ğŸ¯ GOAL  
Add a full marketplace and asset-library system so event professionals can:
â€¢ Upload & manage digital assets (backdrops, templates, AI prompts, graphics)  
â€¢ Share privately with teams or publicly on the Mirror Marketplace  
â€¢ Set prices or download rules (â€œfree with credit,â€ â€œlicense required,â€ etc.)  
â€¢ Preview assets and install them into bookings or design collections  
â€¢ Integrate with existing brands & owner accounts for revenue tracking

---

ğŸ§  DATABASE MIGRATIONS
```sql
create table if not exists assets (
  id uuid primary key default gen_random_uuid(),
  owner_id uuid references users(id) on delete cascade,
  brand_id uuid references brands(id) on delete set null,
  title text not null,
  description text,
  category text check (category in ('backdrop','template','prompt','photo','misc')),
  file_url text not null,
  thumbnail_url text,
  tags text[],
  price numeric(10,2) default 0,
  currency text default 'USD',
  visibility text default 'private', -- 'private' | 'team' | 'public'
  license_type text default 'standard', -- 'standard' | 'commercial' | 'editorial'
  downloads integer default 0,
  likes integer default 0,
  is_active boolean default true,
  created_at timestamptz default now()
);

create table if not exists asset_orders (
  id uuid primary key default gen_random_uuid(),
  asset_id uuid references assets(id) on delete cascade,
  buyer_id uuid references users(id) on delete cascade,
  price numeric(10,2),
  currency text,
  status text default 'completed',
  created_at timestamptz default now()
);
````

Add indexes on `assets(owner_id)`, `assets(category)`, `assets(tags)`, and `asset_orders(buyer_id)`.

---

âš™ï¸ SERVER ROUTES (`/server/routes/marketplace.js`)
1ï¸âƒ£ `GET /api/marketplace/assets?category=&tag=&brand_id=&visibility=`
â€ƒReturns public assets filtered by params.

2ï¸âƒ£ `GET /api/marketplace/assets/:id`
â€ƒFetch asset detail with owner info and license terms.

3ï¸âƒ£ `POST /api/marketplace/assets` (JWT required)
â€ƒUpload new asset (metadata + file URL). Use existing upload middleware.

4ï¸âƒ£ `PATCH /api/marketplace/assets/:id` â†’ edit fields (title, price, tags, visibility).

5ï¸âƒ£ `DELETE /api/marketplace/assets/:id` â†’ soft delete (`is_active=false`).

6ï¸âƒ£ `POST /api/marketplace/purchase/:id`
â€ƒâ†’ Creates `asset_orders` row (simulate payment now; Square integration later).

7ï¸âƒ£ `GET /api/marketplace/my-assets` â†’ assets uploaded by current user.
8ï¸âƒ£ `GET /api/marketplace/my-purchases` â†’ assets purchased by current user.

All routes tenant-scoped by `owner_id` and respect visibility rules.

---

ğŸ’¾ SERVER HELPERS
`/server/lib/licensing.js`

```js
export function checkLicense(asset, user) {
  if (asset.visibility === 'public') return true;
  if (asset.visibility === 'team' && asset.owner_id === user.owner_id) return true;
  return asset.owner_id === user.id;
}
```

`/server/lib/paymentSim.js`

```js
export async function simulatePurchase(asset, buyer, db) {
  await db.query(
    "insert into asset_orders(asset_id,buyer_id,price,currency) values($1,$2,$3,$4)",
    [asset.id, buyer.id, asset.price, asset.currency]
  );
  await db.query("update assets set downloads=downloads+1 where id=$1", [asset.id]);
  return {ok:true};
}
```

---

ğŸ¨ CLIENT (UI)
Add two new pages:

**1ï¸âƒ£ AssetLibraryPage.jsx**

* Table of userâ€™s assets with upload button
* â€œ+ Upload Assetâ€ modal: title, description, category, file upload, tags, visibility, price
* Edit/Delete actions

**2ï¸âƒ£ MarketplacePage.jsx**

* Public grid view with filters (category, tags, brand) and search bar
* Card design with: thumbnail, title, owner badge, price pill, â¤ï¸ likes, ğŸ¡‡ downloads
* Click â†’ opens `AssetDetailDrawer` with preview, license info, download/purchase button
* â€œInstall to My Libraryâ€ if already purchased or free

Add routes to sidebar (visible to all roles).

---

ğŸ¨ STYLE

* Use rainbow gradient frames for asset cards.
* Add hover shine animation.
* Dark-mode friendly backgrounds.
* Use lazy loading for images.

---

ğŸ§© INTEGRATIONS (NOT LIVE YET)
Prepare hooks for:

* Square Payments (`/server/lib/square.js`) placeholder
* Future AI Prompt Sync (`/server/lib/promptSync.js`)

---

âœ… ACCEPTANCE CRITERIA

1. Users can upload, list, and manage assets.
2. Marketplace shows public assets with filters.
3. Purchasing (simulated) logs download + creates order.
4. Purchased assets appear in â€œMy Library.â€
5. Licensing & visibility rules enforced correctly.
6. UI matches Empress aesthetic with gradient borders and soft cards.

---

ğŸ›¡ï¸ SECURITY / DX

* File upload limit 25 MB; virus scan optional stub.
* Validate price â‰¥ 0; sanitize titles/descriptions.
* Paginate marketplace responses (20 per page).
* Cache public marketplace responses (60 s per filter).

---

ğŸ“„ DEV CHECKLIST

* Run migration and seed a few demo assets.
* Build upload & marketplace UI.
* Confirm filtering and purchase flows.
* Verify tenant scope with multiple brands.

Report completion as:
â€œMirror Marketplace & Asset Library ready â€” users can upload, share, and trade creative assets securely across brands.â€

```

---

âœ… Once this sprint passes testing, Rainbow CRM becomes a **multi-brand SaaS with its own mini-marketplace** â€” ready for monetization, prompt-pack sales, and community exchange.

Would you like me to design the **Sprint 12 payload (Team Chat + Real-Time Collaboration)** next so itâ€™s ready to paste the moment Marketplace passes review?
```
